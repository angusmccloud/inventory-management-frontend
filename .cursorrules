# ATL-Inventory Context Rules for Cursor

## MCP Integration

This file is a thin adapter that references canonical context sources.
**DO NOT duplicate content here** - reference the source files instead.

---

## ğŸ”´ Critical Context (Always Load)

Before ANY implementation, load and understand:

### 1. Constitution (NON-NEGOTIABLE Authority)
**Location**: `@file:../../../inventory-management-context/prompts/constitution.md`

The constitution defines:
- Architecture principles
- TypeScript strict mode requirements
- Testing requirements (Jest + 80% coverage)
- DynamoDB patterns
- Security standards
- Performance guidelines

**Ask yourself**: What does the constitution say about this?

### 2. Agent Guidance (Critical Gotchas)
**Location**: `@file:../../../inventory-management-context/AGENTS.md`

Contains:
- AI-specific patterns and conventions
- Critical gotchas to avoid
- Feature branch naming (`###-feature-name`)
- SpecKit workflow
- Code patterns

**Ask yourself**: What are the AGENTS.md gotchas for this feature?

### 3. Onboarding (Setup & Workflow)
**Location**: `@file:../../../inventory-management-context/ONBOARDING.md`

Reference for:
- Project structure
- Setup instructions
- Development workflow
- Common development tasks

---

## ğŸ¯ Feature-Specific Context (Load When Relevant)

### When Working with Database:
**Load**: `@file:../../../inventory-management-backend/src/types/entities.ts`
- Entity definitions
- KeyBuilder helpers (ALWAYS use these)
- QueryPatterns for common queries
- Single-table design patterns

**Rules**:
- âœ… Use `KeyBuilder` for key construction
- âœ… Use `QueryPatterns` for queries
- âŒ Never manually construct PK/SK
- âŒ No migrations (schema is in code)

### When Creating API Handlers:
**Load**: `@file:../../../inventory-management-backend/src/lib/response.ts`
**Load**: `@file:../../../inventory-management-backend/src/lib/logger.ts`
- Response formatting patterns
- Error handling patterns
- Structured logging

**Rules**:
- âœ… Use `successResponse`, `errorResponse`, etc.
- âœ… Use `logger` for structured logging
- âŒ No console.log statements

### When Working with DynamoDB Client:
**Load**: `@file:../../../inventory-management-backend/src/lib/dynamodb.ts`
- Document Client configuration
- Error handling
- Table name management

---

## ğŸ“‹ Implementation Checklist

Before writing ANY code:

- [ ] Read constitution requirements for this feature type
- [ ] Check AGENTS.md for relevant gotchas
- [ ] Review existing patterns in codebase
- [ ] Identify which entities.ts patterns to use
- [ ] Confirm testing strategy (unit vs integration)
- [ ] Verify response/logging patterns

---

## ğŸš¨ Mandatory Rules (Constitution)

### TypeScript
- âœ… Strict mode enabled
- âœ… No implicit `any` types
- âœ… Explicit types everywhere

### Testing
- âœ… Test-first development
- âœ… Unit tests with mocks
- âœ… Integration tests for DynamoDB
- âœ… 80% coverage on critical paths
- âœ… Use Jest + aws-sdk-client-mock

### DynamoDB
- âœ… Use KeyBuilder from entities.ts
- âœ… Use QueryPatterns for queries
- âœ… Single-table design
- âŒ No migrations
- âŒ No manual key construction

### Code Style
- âœ… ES modules (`.js` extensions in imports)
- âœ… Async/await (no callbacks)
- âœ… Proper error handling
- âœ… Structured logging

---

## ğŸ’¡ Context Questions to Ask

When implementing a feature:

1. **"What does the constitution say?"**
   - Check architecture principles
   - Verify testing requirements
   - Confirm standards

2. **"What are the gotchas?"**
   - Review AGENTS.md
   - Check for feature-specific warnings
   - Look for common mistakes

3. **"What patterns exist?"**
   - Review entities.ts for data patterns
   - Check response.ts for API patterns
   - Look at existing handlers

4. **"How should this be tested?"**
   - Unit tests: Mock DynamoDB
   - Integration tests: DynamoDB Local
   - 80% coverage requirement

---

## ğŸ”„ Context Priority

When conflicts arise, priority order:

1. **Constitution** (HIGHEST - non-negotiable)
2. **AGENTS.md** (Critical guidance)
3. **Existing code patterns** (Follow what works)
4. **Specifications** (Feature requirements)

---

## ğŸ“ Example Workflow

```
User: "Create endpoint to add inventory item"

AI Process:
1. Load constitution â†’ Check testing, architecture requirements
2. Load AGENTS.md â†’ Check for DynamoDB/API gotchas
3. Load entities.ts â†’ Find InventoryItem entity, KeyBuilder
4. Load response.ts â†’ Find response patterns
5. Review existing handlers â†’ Follow established patterns
6. Implement with:
   - KeyBuilder for keys
   - Response helpers for output
   - Structured logging
   - Proper error handling
7. Create unit tests (mocked)
8. Create integration tests (DynamoDB Local)
9. Verify 80% coverage
```

---

**MCP Version**: 1.0.0
**Last Updated**: 2025-12-09
**Canonical Sources**: ../../../inventory-management-context/

